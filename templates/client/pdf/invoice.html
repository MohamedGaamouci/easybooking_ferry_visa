{% load humanize %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Invoice #{{ invoice.invoice_number }}</title>
    <style>
        @page {
            size: a4 portrait;
            margin: 1cm 1.5cm;

            /* Tighter margins to keep everything on one page */
            @frame footer_frame {
                -pdf-frame-content: footerContent;
                bottom: 1cm;
                height: 1cm;
            }
        }

        body {
            font-family: Helvetica, Arial, sans-serif;
            font-size: 13px;
            /* Increased base font size */
            color: #1e293b;
            line-height: 1.4;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        .text-right {
            text-align: right;
        }

        .uppercase {
            text-transform: uppercase;
        }

        /* HEADER SECTION */
        .invoice-title {
            font-size: 42px;
            /* Huge title */
            color: #0c4a6e;
            font-weight: bold;
            margin: 0;
        }

        .logo {
            width: 180px;
            height: auto;
        }

        /* STATUS BADGE */
        .status-header {
            font-size: 14px;
            font-weight: bold;
            padding: 8px 20px;
            display: inline-block;
            border-radius: 4px;
        }

        .paid {
            background-color: #15803d;
            color: white;
        }

        .unpaid {
            background-color: #dc2626;
            color: white;
        }

        /* INFORMATION BLOCKS */
        .info-label {
            font-size: 10px;
            color: #64748b;
            font-weight: bold;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .client-name {
            font-size: 18px;
            font-weight: bold;
            color: #0f172a;
        }

        /* ITEMS TABLE */
        .items-table {
            margin-top: 30px;
        }

        .items-table th {
            background-color: #0c4a6e;
            color: white;
            padding: 12px;
            font-size: 12px;
            text-align: left;
        }

        .items-table td {
            padding: 15px 12px;
            border-bottom: 2px solid #f1f5f9;
            font-size: 13px;
        }

        /* TOTALS SECTION */
        .total-row td {
            padding-top: 20px;
            font-size: 16px;
        }

        .grand-total {
            font-size: 26px;
            color: #0c4a6e;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <table style="margin-bottom: 40px;">
        <tr>
            <td width="50%" style="vertical-align: top;">
                <img src="https://easybooking.pro/Images/Logo2.png" class="logo">
                <div style="margin-top: 15px;">
                    <strong style="font-size: 16px; color: #0c4a6e;">Easy Booking Pro</strong><br>
                    Cit√© Touahria Mohamed, Relizane<br>
                    <span style="color: #0284c7;">support@easybooking.pro</span>
                </div>
            </td>
            <td width="50%" class="text-right" style="vertical-align: top;">
                <h1 class="invoice-title">INVOICE</h1>
                <div style="margin-top: 10px; margin-bottom: 20px;">
                    <div class="status-header {{ invoice.status }} uppercase">
                        {{ invoice.status }}
                    </div>
                </div>
                <div style="font-size: 14px;">
                    <strong>#{{ invoice.invoice_number }}</strong><br>
                    Date: {{ invoice.created_at|date:"d M Y" }}
                </div>
            </td>
        </tr>
    </table>

    <hr style="color: #f1f5f9; height: 2px; margin-bottom: 30px;">

    <table style="margin-bottom: 40px;">
        <tr>
            <td>
                <div class="info-label uppercase">Billed To</div>
                <div class="client-name">{{ invoice.agency.company_name }}</div>
                <div style="font-size: 13px; color: #475569; margin-top: 5px;">
                    {{ invoice.agency.address|default:"---" }}<br>
                    {{ invoice.agency.email }}
                </div>
            </td>
        </tr>
    </table>

    <table class="items-table">
        <thead>
            <tr>
                <th width="75%" class="uppercase">Service Description</th>
                <th width="25%" class="text-right uppercase">Amount</th>
            </tr>
        </thead>
        <tbody>
            {% for item in invoice.items.all %}
            <tr>
                <td>
                    <div style="font-weight: bold;">{{ item.description }}</div>
                    {% if item.service_object %}
                    <div style="color: #64748b; font-size: 11px; margin-top: 4px;">REF: {{ item.service_object }}</div>
                    {% endif %}
                </td>
                <td class="text-right" style="font-weight: bold; font-size: 15px;">
                    {{ item.amount|intcomma }} <small style="font-size: 10px; color: #94a3b8;">DZD</small>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <table style="margin-top: 30px;">
        <tr>
            <td width="50%"></td>
            <td width="50%">
                <table>
                    <tr>
                        <td class="text-right" style="color: #64748b; font-size: 14px; padding-bottom: 10px;">Subtotal:
                        </td>
                        <td class="text-right" style="font-weight: bold; font-size: 14px; padding-bottom: 10px;">
                            {{invoice.total_amount|intcomma }} DZD</td>
                    </tr>
                    <tr class="total-row">
                        <td class="text-right uppercase" style="font-weight: bold; color: #0c4a6e;">Total Amount:</td>
                        <td class="text-right grand-total">{{ invoice.total_amount|intcomma }} DZD</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <div id="footerContent" style="text-align: center; border-top: 2px solid #f1f5f9; padding-top: 10px;">
        <div style="color: #94a3b8; font-size: 10px; font-weight: bold;">
            WWW.EASYBOOKING.PRO
        </div>
    </div>

</body>

</html>