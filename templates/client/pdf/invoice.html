{% load humanize %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Invoice #{{ invoice.invoice_number }}</title>
    <style>
        /* Define Page Size */
        @page {
            size: a4 portrait;
            margin: 2cm;

            @frame footer_frame {
                -pdf-frame-content: footerContent;
                bottom: 1cm;
                margin-left: 2cm;
                margin-right: 2cm;
                height: 1cm;
            }
        }

        body {
            font-family: Helvetica, sans-serif;
            font-size: 12px;
            color: #333;
        }

        /* Layout Tables */
        table.layout {
            width: 100%;
            border: none;
            margin-bottom: 20px;
        }

        td.layout {
            vertical-align: top;
            padding: 0;
        }

        /* Header Styles */
        h1 {
            color: #2563eb;
            font-size: 24px;
            margin: 0;
        }

        h2 {
            font-size: 18px;
            color: #333;
            margin: 0;
            text-align: right;
        }

        .company-meta {
            color: #666;
            font-size: 10px;
            line-height: 1.4;
        }

        /* Data Tables */
        table.items {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table.items th {
            background-color: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            padding: 8px;
            text-align: left;
            font-size: 10px;
            text-transform: uppercase;
            color: #64748b;
        }

        table.items td {
            border-bottom: 1px solid #e2e8f0;
            padding: 10px 8px;
        }

        /* Status Badge */
        .watermark {
            color: #ccc;
            font-size: 40px;
            font-weight: bold;
            text-align: center;
            text-transform: uppercase;
            padding: 20px;
            border: 3px solid #ccc;
        }

        .paid {
            color: #22c55e;
            border-color: #22c55e;
        }

        .unpaid {
            color: #ef4444;
            border-color: #ef4444;
        }
    </style>
</head>

<body>

    <table class="layout">
        <tr>
            <td class="layout" width="60%">
                <h1>Easy Booking</h1>
                <div class="company-meta">
                    123 Travel Road, Algiers<br>
                    support@easybooking.pro<br>
                    +213 555 123 456
                </div>
            </td>
            <td class="layout" width="40%" align="right">
                <h2>INVOICE</h2>
                <div style="text-align: right; margin-top: 5px;">
                    <strong>#{{ invoice.invoice_number }}</strong><br>
                    Date: {{ invoice.created_at|date:"M d, Y" }}
                </div>

                <br><br>
                <div class="watermark {{ invoice.status }}">
                    {{ invoice.status }}
                </div>
            </td>
        </tr>
    </table>

    <hr color="#e2e8f0" size="1">

    <table class="layout" style="margin-top: 20px;">
        <tr>
            <td class="layout">
                <strong style="color: #64748b; font-size: 10px; text-transform: uppercase;">Bill To:</strong><br>
                <div style="font-size: 14px; font-weight: bold; margin-top: 5px;">
                    {{ invoice.agency.company_name }}
                </div>
                <div>{{ invoice.agency.address|default:"-" }}</div>
                <div>{{ invoice.agency.email }}</div>
            </td>
        </tr>
    </table>

    <table class="items">
        <thead>
            <tr>
                <th width="70%">Description</th>
                <th width="30%" align="right">Amount (DZD)</th>
            </tr>
        </thead>
        <tbody>
            {% for item in invoice.items.all %}
            <tr>
                <td>
                    <b>{{ item.description }}</b>
                    {% if item.service_object %}
                    <br><span style="color: #94a3b8; font-size: 9px;">Ref: {{ item.service_object }}</span>
                    {% endif %}
                </td>
                <td align="right">{{ item.amount|intcomma }}</td>
            </tr>
            {% endfor %}

            <tr>
                <td align="right" style="border-top: 2px solid #333; padding-top: 10px;">
                    <strong>TOTAL</strong>
                </td>
                <td align="right" style="border-top: 2px solid #333; padding-top: 10px; font-size: 14px;">
                    <strong>{{ invoice.total_amount|intcomma }} DZD</strong>
                </td>
            </tr>
        </tbody>
    </table>

    <div id="footerContent" style="text-align: center; color: #94a3b8; font-size: 9px;">
        Thank you for your business. | Easy Booking Platform
    </div>

</body>

</html>