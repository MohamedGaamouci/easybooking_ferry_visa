{% extends 'admin/base_admin.html' %}

{% block content %}

<main class="flex-1 flex flex-col h-screen overflow-hidden relative">

    <header class="h-16 bg-white border-b border-slate-200 flex items-center justify-between px-8 shrink-0">
        <h1 class="text-xl font-bold text-slate-900">Product Management (CMS)</h1>
        <div class="flex items-center gap-3">
            <button class="text-slate-500 hover:text-brand-600 font-medium text-sm flex items-center gap-1">
                <i class="ph-bold ph-eye"></i> View Client Site
            </button>
        </div>
    </header>

    <div class="flex-1 overflow-y-auto p-8">
        <div class="max-w-7xl mx-auto space-y-12">

            <section>
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <h2 class="text-lg font-bold text-slate-900">Ferry Providers</h2>
                        <span class="bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded font-medium">System
                            Status</span>
                    </div>
                    <button onclick="openFerryModal('new')"
                        class="bg-white border border-slate-300 text-slate-700 px-4 py-2 rounded-lg text-sm font-bold shadow-sm hover:bg-slate-50 flex items-center gap-2 transition-colors">
                        <i class="ph-bold ph-plus"></i> Add Provider
                    </button>
                </div>

                <div class="bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden">
                    <table class="w-full text-left border-collapse">
                        <thead
                            class="bg-slate-50 text-xs uppercase text-slate-500 font-semibold border-b border-slate-200">
                            <tr>
                                <th class="px-6 py-4">Logo</th>
                                <th class="px-6 py-4">Provider Name</th>
                                <th class="px-6 py-4">Service Markup</th>
                                <th class="px-6 py-4">Status</th>
                                <th class="px-6 py-4 text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-100 text-sm">

                            <tr class="hover:bg-slate-50 group">
                                <td class="px-6 py-4">
                                    <div class="w-10 h-10 bg-slate-100 rounded flex items-center justify-center"><i
                                            class="ph-fill ph-anchor text-xl text-slate-400"></i></div>
                                </td>
                                <td class="px-6 py-4 font-bold text-slate-800">Corsica Linea</td>
                                <td class="px-6 py-4">
                                    <span
                                        class="bg-brand-50 text-brand-700 border border-brand-100 px-2 py-1 rounded font-bold text-xs">+
                                        15%</span>
                                </td>
                                <td class="px-6 py-4"><span
                                        class="flex items-center gap-1.5 text-green-600 font-bold text-xs"><span
                                            class="w-2 h-2 rounded-full bg-green-500"></span> Active</span></td>
                                <td class="px-6 py-4 text-right">
                                    <div class="flex justify-end gap-2">
                                        <button onclick="openFerryModal('edit')"
                                            class="w-8 h-8 rounded hover:bg-slate-200 flex items-center justify-center text-slate-500"><i
                                                class="ph-bold ph-pencil-simple"></i></button>
                                        <button onclick="confirmDelete()"
                                            class="w-8 h-8 rounded hover:bg-red-50 flex items-center justify-center text-red-500"><i
                                                class="ph-bold ph-trash"></i></button>
                                    </div>
                                </td>
                            </tr>

                            <tr class="hover:bg-slate-50 group">
                                <td class="px-6 py-4">
                                    <div class="w-10 h-10 bg-slate-100 rounded flex items-center justify-center"><i
                                            class="ph-fill ph-flag text-xl text-slate-400"></i></div>
                                </td>
                                <td class="px-6 py-4 font-bold text-slate-800">Balearia</td>
                                <td class="px-6 py-4">
                                    <span
                                        class="bg-slate-100 text-slate-600 border border-slate-200 px-2 py-1 rounded font-bold text-xs">+
                                        € 10.00</span>
                                </td>
                                <td class="px-6 py-4"><span
                                        class="flex items-center gap-1.5 text-orange-500 font-bold text-xs"><span
                                            class="w-2 h-2 rounded-full bg-orange-500 animate-pulse"></span>
                                        Maintenance</span></td>
                                <td class="px-6 py-4 text-right">
                                    <div class="flex justify-end gap-2">
                                        <button onclick="openFerryModal('edit')"
                                            class="w-8 h-8 rounded hover:bg-slate-200 flex items-center justify-center text-slate-500"><i
                                                class="ph-bold ph-pencil-simple"></i></button>
                                        <button onclick="confirmDelete()"
                                            class="w-8 h-8 rounded hover:bg-red-50 flex items-center justify-center text-red-500"><i
                                                class="ph-bold ph-trash"></i></button>
                                    </div>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                </div>
            </section>

            <section>
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <h2 class="text-lg font-bold text-slate-900">Visa Destinations</h2>
                        <span
                            class="bg-purple-100 text-purple-700 text-xs px-2 py-0.5 rounded font-medium">Catalog</span>
                    </div>
                    <button onclick="openVisaModal('new')"
                        class="bg-brand-600 text-white px-4 py-2 rounded-lg text-sm font-bold shadow-md hover:bg-brand-700 transition-colors flex items-center gap-2">
                        <i class="ph-bold ph-plus-circle"></i> Add New Visa
                    </button>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">

                    <div
                        class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden group hover:shadow-md transition-shadow relative">
                        <div class="h-40 bg-cover bg-center"
                            style="background-image: url('https://images.unsplash.com/photo-1502602898657-3e91760cbb34?q=80&w=600');">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-black/20 transition-colors">
                            </div>

                            <div class="absolute top-2 left-2">
                                <span
                                    class="bg-green-500 text-white text-[10px] font-bold px-2 py-0.5 rounded shadow-sm">Active</span>
                            </div>

                            <div
                                class="absolute top-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button onclick="openVisaModal('edit')"
                                    class="w-8 h-8 bg-white/90 rounded-full flex items-center justify-center text-slate-700 hover:text-brand-600 shadow-sm"><i
                                        class="ph-bold ph-pencil-simple"></i></button>
                                <button onclick="confirmDelete()"
                                    class="w-8 h-8 bg-white/90 rounded-full flex items-center justify-center text-red-500 hover:bg-red-50 shadow-sm"><i
                                        class="ph-bold ph-trash"></i></button>
                            </div>
                            <div class="absolute bottom-3 left-4 text-white">
                                <h3 class="font-bold text-lg">France</h3>
                                <p class="text-xs opacity-90">Schengen Area</p>
                            </div>
                        </div>
                        <div class="p-4 flex justify-between items-center border-t border-slate-100">
                            <div>
                                <p class="text-xs text-slate-500 uppercase font-bold">Base Price</p>
                                <p class="font-bold text-slate-900">€ 120.00</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xs text-slate-500 uppercase font-bold">Fee (Flat)</p>
                                <p class="font-bold text-green-600">+ € 20.00</p>
                            </div>
                        </div>
                    </div>

                    <div
                        class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden group hover:shadow-md transition-shadow relative opacity-75">
                        <div class="h-40 bg-cover bg-center grayscale"
                            style="background-image: url('https://images.unsplash.com/photo-1500539746430-b9df74fa191b?q=80&w=600');">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-black/20 transition-colors">
                            </div>

                            <div class="absolute top-2 left-2">
                                <span
                                    class="bg-slate-500 text-white text-[10px] font-bold px-2 py-0.5 rounded shadow-sm">Disabled</span>
                            </div>

                            <div
                                class="absolute top-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                <button onclick="openVisaModal('edit')"
                                    class="w-8 h-8 bg-white/90 rounded-full flex items-center justify-center text-slate-700 hover:text-brand-600 shadow-sm"><i
                                        class="ph-bold ph-pencil-simple"></i></button>
                                <button onclick="confirmDelete()"
                                    class="w-8 h-8 bg-white/90 rounded-full flex items-center justify-center text-red-500 hover:bg-red-50 shadow-sm"><i
                                        class="ph-bold ph-trash"></i></button>
                            </div>
                            <div class="absolute bottom-3 left-4 text-white">
                                <h3 class="font-bold text-lg">United States</h3>
                                <p class="text-xs opacity-90">B1/B2 Tourism</p>
                            </div>
                        </div>
                        <div class="p-4 flex justify-between items-center border-t border-slate-100">
                            <div>
                                <p class="text-xs text-slate-500 uppercase font-bold">Base Price</p>
                                <p class="font-bold text-slate-900">€ 280.00</p>
                            </div>
                            <div class="text-right">
                                <p class="text-xs text-slate-500 uppercase font-bold">Fee (Flat)</p>
                                <p class="font-bold text-green-600">+ € 35.00</p>
                            </div>
                        </div>
                    </div>

                </div>
            </section>

        </div>
    </div>

</main>

<div id="visa-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity" onclick="closeVisaModal()">
    </div>
    <div
        class="relative bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden modal-enter flex flex-col max-h-[90vh]">
        <div class="bg-purple-700 p-4 flex justify-between items-center text-white shrink-0">
            <h3 class="font-bold flex items-center gap-2"><i class="ph-bold ph-passport"></i> Manage Visa
                Destination</h3>
            <button onclick="closeVisaModal()"><i class="ph-bold ph-x"></i></button>
        </div>
        <div class="p-6 overflow-y-auto">
            <form onsubmit="event.preventDefault(); saveVisa();" class="space-y-6">
                <div class="grid grid-cols-2 gap-4">
                    <div><label class="block text-xs font-bold text-slate-500 uppercase mb-1">Country
                            Name</label><input type="text"
                            class="w-full border border-slate-300 rounded-lg p-2.5 text-sm focus:ring-2 focus:ring-purple-500 outline-none">
                    </div>
                    <div><label class="block text-xs font-bold text-slate-500 uppercase mb-1">Visa
                            Type</label><input type="text"
                            class="w-full border border-slate-300 rounded-lg p-2.5 text-sm focus:ring-2 focus:ring-purple-500 outline-none">
                    </div>
                </div>

                <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Pricing Strategy</label>
                    <div class="grid grid-cols-3 gap-4">
                        <div><label class="block text-[10px] font-bold text-slate-400 mb-1">Embassy Base Cost
                                (€)</label><input type="number"
                                class="w-full border border-slate-300 rounded-lg p-2.5 text-sm font-bold"></div>

                        <div class="col-span-2 flex gap-2">
                            <div class="w-full">
                                <label class="block text-[10px] font-bold text-slate-400 mb-1">Agency Markup</label>
                                <input type="number" value="20.00"
                                    class="w-full border border-slate-300 rounded-lg p-2.5 text-sm font-bold text-green-700">
                            </div>
                            <div class="w-1/2">
                                <label class="block text-[10px] font-bold text-slate-400 mb-1">Type</label>
                                <select class="w-full border border-slate-300 rounded-lg p-2.5 text-sm bg-white">
                                    <option value="flat" selected>Flat (€)</option>
                                    <option value="percent">Percent (%)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div><label class="block text-xs font-bold text-slate-500 uppercase mb-2">Requirements
                        List</label><textarea
                        class="w-full border border-slate-300 rounded-lg p-3 text-sm h-32 focus:ring-2 focus:ring-purple-500 outline-none"></textarea>
                </div>

                <div class="flex items-center justify-between border-t border-slate-100 pt-4">
                    <span class="text-sm font-bold text-slate-700">Client Visibility</span>
                    <label class="flex items-center cursor-pointer">
                        <div class="relative inline-block w-12 h-6 align-middle select-none">
                            <input type="checkbox" checked
                                class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer border-slate-300" />
                            <label
                                class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-200 cursor-pointer"></label>
                        </div>
                        <span class="ml-2 text-xs font-medium text-slate-500">Active</span>
                    </label>
                </div>

                <div class="pt-4 flex justify-end gap-3">
                    <button type="button" onclick="closeVisaModal()"
                        class="px-4 py-2 text-slate-500 font-bold text-sm">Cancel</button>
                    <button type="submit"
                        class="bg-purple-600 text-white font-bold py-2 px-6 rounded-lg shadow hover:bg-purple-700">Save
                        Visa</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="ferry-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity" onclick="closeFerryModal()">
    </div>
    <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden modal-enter">
        <div class="bg-blue-700 p-4 flex justify-between items-center text-white shrink-0">
            <h3 class="font-bold flex items-center gap-2"><i class="ph-bold ph-anchor"></i> Manage Ferry Provider
            </h3>
            <button onclick="closeFerryModal()"><i class="ph-bold ph-x"></i></button>
        </div>
        <div class="p-6">
            <form onsubmit="event.preventDefault(); saveFerry();" class="space-y-6">

                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Provider Name</label>
                    <input type="text" placeholder="e.g. Trasmediterranea"
                        class="w-full border border-slate-300 rounded-lg p-2.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Logo URL</label>
                    <input type="text" placeholder="https://..."
                        class="w-full border border-slate-300 rounded-lg p-2.5 text-sm focus:ring-2 focus:ring-blue-500 outline-none">
                </div>

                <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Service Fee /
                        Markup</label>
                    <div class="flex gap-4">
                        <div class="w-full">
                            <label class="block text-[10px] font-bold text-slate-400 mb-1">Value</label>
                            <input type="number" value="5"
                                class="w-full border border-slate-300 rounded-lg p-2.5 text-sm font-bold text-blue-700">
                        </div>
                        <div class="w-1/2">
                            <label class="block text-[10px] font-bold text-slate-400 mb-1">Unit</label>
                            <select class="w-full border border-slate-300 rounded-lg p-2.5 text-sm bg-white">
                                <option value="percent" selected>Percent (%)</option>
                                <option value="flat">Flat (€)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="flex items-center justify-between">
                    <span class="text-sm font-bold text-slate-700">System Status</span>
                    <label class="flex items-center cursor-pointer">
                        <div class="relative inline-block w-12 h-6 align-middle select-none">
                            <input type="checkbox" checked
                                class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer border-slate-300" />
                            <label
                                class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-200 cursor-pointer"></label>
                        </div>
                        <span class="ml-2 text-xs font-medium text-slate-500">Active</span>
                    </label>
                </div>

                <div class="pt-4 border-t border-slate-100 flex justify-end gap-3">
                    <button type="button" onclick="closeFerryModal()"
                        class="px-4 py-2 text-slate-500 font-bold text-sm">Cancel</button>
                    <button type="submit"
                        class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg shadow hover:bg-blue-700">Save
                        Provider</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // --- VISA MODAL ---
    const visaModal = document.getElementById('visa-modal');
    function openVisaModal(mode) { visaModal.classList.remove('hidden'); }
    function closeVisaModal() { visaModal.classList.add('hidden'); }
    function saveVisa() {
        const btn = document.querySelector('#visa-modal button[type="submit"]');
        btn.innerHTML = 'Saving...';
        setTimeout(() => { alert("Visa Destination Saved!"); closeVisaModal(); btn.innerHTML = 'Save Visa'; }, 800);
    }

    // --- FERRY MODAL ---
    const ferryModal = document.getElementById('ferry-modal');
    function openFerryModal(mode) { ferryModal.classList.remove('hidden'); }
    function closeFerryModal() { ferryModal.classList.add('hidden'); }
    function saveFerry() {
        const btn = document.querySelector('#ferry-modal button[type="submit"]');
        btn.innerHTML = 'Saving...';
        setTimeout(() => { alert("Provider Updated Successfully!"); closeFerryModal(); btn.innerHTML = 'Save Provider'; }, 800);
    }

    // --- GLOBAL DELETE ---
    function confirmDelete() {
        if (confirm("Are you sure you want to delete this item? This action cannot be undone.")) {
            alert("Item deleted.");
        }
    }
</script>

{% endblock %}